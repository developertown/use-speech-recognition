"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t,n,e=require("typescript-fsa-reducers"),r=require("typescript-fsa"),i=require("react");function o(){return(o=Object.assign||function(t){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t}).apply(this,arguments)}!function(t){t.READY="ready",t.STOPPED="stopped",t.STARTED="started",t.ERROR="error",t.RESET="reset"}(t||(t={})),function(t){t.RESET="RESET",t.STOP="STOP"}(n||(n={}));var s=r.actionCreatorFactory("SPEECH_RECOGNITION"),c=s("SET_TRANSCRIPT"),u=s("SET_STATUS"),a=s("SET_FINAL_TRANSCRIPT"),l=s("SET_INTERIM_TRANSCRIPT"),f=s("SET_PAUSE_AFTER_DISCONNECT"),p={status:t.READY,transcript:"",interimTranscript:"",finalTranscript:"",pauseAfterDisconnect:!1},T=e.reducerWithInitialState(p).case(c,(function(t,n){return o(o({},t),{},{transcript:n})})).case(f,(function(t,n){return o(o({},t),{},{pauseAfterDisconnect:n})})).case(l,(function(t,n){return o(o({},t),{},{interimTranscript:n})})).case(a,(function(t,n){return o(o({},t),{},{finalTranscript:n})})).case(u,(function(t,n){return o(o({},t),{},{status:n})})),S={autoStart:!1,continuous:!1,interimResults:!0,onResult:function(){},onDisconnect:function(){},onStart:function(){}};function E(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return n.map((function(t){return t.trim()})).join(" ").trim()}exports.defaultOptions=S,exports.useSpeechRecognition=function(e){void 0===e&&(e=S);var r=i.useReducer(T,p),o=r[0],s=o.status,R=o.pauseAfterDisconnect,d=o.interimTranscript,g=o.finalTranscript,P=o.transcript,w=r[1],O=i.useMemo((function(){var t="undefined"!=typeof window&&(window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition||window.oSpeechRecognition);if(t)return new t;throw new Error("Speech recognition is not supported on this device")}),[]),h=i.useCallback((function(e){if(O)switch(e){case n.RESET:w(u(t.RESET)),w(f(!1)),O.abort();break;case n.STOP:default:w(u(t.STOPPED)),w(f(!0)),O.stop()}}),[O]),A=i.useCallback((function(){h(n.RESET),w(c("")),w(l("")),w(a(""))}),[h]),D=i.useCallback((function(){if(console.log("Running start listening"),O&&s!==t.STARTED){O.continuous||A();try{O.start(),w(u(t.STARTED))}catch(t){}}}),[s,O,A]),m=i.useCallback((function(){console.log("Running stop listening"),h(n.STOP),w(u(t.STOPPED))}),[h]),C=i.useCallback((function(t){console.log("updating transcript",t);for(var n="",r="",i=t.resultIndex;i<t.results.length;++i)t.results[i].isFinal?r=E(r,t.results[i][0].transcript):n=E(n,t.results[i][0].transcript);w(c(E(r,n))),w(l(n)),w(a(r)),e.onResult&&e.onResult(r,n)}),[e]),b=i.useCallback((function(){w(u(t.STOPPED)),R?w(u(t.STOPPED)):O&&(O.continuous?D():w(u(t.STOPPED))),w(f(!1))}),[R,O,D]),v=i.useCallback((function(t){var n=t.message;console.log("Speech recognition error detected: "+t.error),console.log("Additional information: "+n)}),[]);return i.useEffect((function(){O&&(O.continuous=!1!==e.continuous,O.interimResults=e.interimResults,O.onresult=C,O.onend=b,O.onerror=v)}),[b,v,C,O,e.continuous,e.interimResults]),i.useEffect((function(){return O&&e&&e.autoStart&&D(),function(){e&&e.autoStart&&s===t.STARTED&&m()}}),[e,O,D,s,m]),{transcript:P,interimTranscript:d,finalTranscript:g,status:s,resetTranscript:A,startListening:D,stopListening:m}};
//# sourceMappingURL=use-speech-recognition.cjs.production.min.js.map
